---
title: "Random Forest"
author: "Salerno"
date: '2019-12-23'
categories:
- R
- programming
draft: no
slug: random-forest
tags: random forest
banner: img/banners/banner-5.png
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, warnings = FALSE, echo = TRUE)
```

# Random Forest

In this post we will explore some ideas around the Random Forest model

- number of rows:

```{r}
nrow(BHData)
```

- number of features:

```{r}
ncol(BHData)
```


## Data

```{r}
BHData <- read.table(url("https://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"), sep = "")

```

## Set names of the dataset

```{r}
names(BHData)<- c("crim","zn","indus","chas","nox","rm",   
       "age","dis","rad","tax","ptratio","black","lstat","medv")
```

## EDA (Exploratory Data Analysis)

```{r}
str(BHData)
```

```{r}
summary(BHData)
```

## Pre-processing

It is an important step called `featured scaling` to get all the data scaled in the range [0,1]. This method has chosen can be called as well as `normalization`. 

```{r}
max_data <- apply(BHData, 2, max)
```

```{r}
min_data <- apply(BHData, 2, min)
```

```{r}
BHDataScaled <- as.data.frame(scale(BHData,center = min_data, 
  scale = max_data - min_data))
```

To confirm normalization process:

```{r}
summary(BHDataScaled)
```

```{r}
boxplot(BHDataScaled)
```

```{r}
CorBHData<-cor(BHDataScaled)
```

```{r}
library(corrplot)

corrplot(CorBHData, method = "pie",type="lower")
```

## Multiple Linear Model Fitting

```{r}
LModel1<-lm(medv~.,data=BHDataScaled)
```

```{r}
summary(LModel1)
```

```{r}
Pred1 <- predict(LModel1)
```

```{r}
mse1 <- mean((BHDataScaled$medv - Pred1)^2)
```

```{r}
mse1
```

```{r}
plot(BHDataScaled[,14],Pred1,
     xlab="Actual",ylab="Predicted")
abline(a=0,b=1)
```

```{r}
par(mfrow=c(2,2))
plot(LModel1)
```

## Random Forest Regression Model

```{r}
library(randomForest)
```

```{r}
RFModel=randomForest(medv ~ . , data = BHDataScaled)
RFModel
```

```{r}
summary(RFModel)
```

```{r}
plot(RFModel)
```

```{r}
VarImp<-importance(RFModel)
VarImp<-as.matrix(VarImp[order(VarImp[,1], decreasing = TRUE),])
VarImp
```

```{r}
varImpPlot(RFModel)
```

```{r}
Pred2 <- predict(RFModel)
```

```{r}
plot(BHDataScaled[,14],Pred2,
     xlab="Actual",ylab="Predicted")
abline(a=0,b=1)
```

